
API sec 来构建一个更强韧、可审计、防攻击的系统。下面是系统性整理👇

🔐 API 安全机制分类总览
机制类型	关键措施说明
✅ 身份认证与鉴权	使用 JWT、OAuth2、API Key，实现用户身份校验和权限控制
✅ 数据加密传输	全站启用 HTTPS，确保所有 API 请求与响应在网络中都是加密的
✅ 参数签名校验	接口请求使用签名算法（如 HMAC 或 RSA），防止参数被篡改
✅ 防止重放攻击	添加 nonce、timestamp 字段 + 服务器端时效校验机制
✅ 输入校验与防注入	用白名单方式校验参数，避免 SQL 注入、XSS 攻击
✅ 跨域访问控制	配置 CORS 白名单，限制哪些域名/应用可访问 API
✅ 接口访问频控	限流（如令牌桶、滑动窗口）+ 单用户/IP 每分钟最多访问次数
✅ 安全日志与审计	记录接口调用日志，含时间、IP、用户ID、路径、结果码等，支持追踪回溯
✅ 加密敏感字段	对如手机号、身份证、账号等敏感字段进行 AES/RSA 加密处理
✅ 强制使用 POST/PUT	对重要接口禁止 GET 请求，避免参数暴露在 URL 中
✅ 防止接口刷库	对批量查询结果做分页限制 + 最大返回条数限制
✅ 接口签名防伪造	不接受来自未知来源的请求，必要时绑定 IP 或设备标识
✅ 权限细粒度控制	接口权限绑定角色，区分商户、管理员、客服等角色的接口访问能力
✅ CSRF 防护机制	jwt模式，使用 CSRF Token 或 SameSite Cookie 属性，保护表单类接口
🧠 金融场景特别建议（你项目背景）
对下单、查询、回调接口都需做 签名校验 + 幂等控制

使用 JWT 时，加上 kid + exp 控制有效期

商户后台接口建议增加 会话管理 + 多因子认证

重放攻击防护建议实现时间窗口校验 + nonce 库

三方对接需验证源域名/IP + 接口白名单

接口返回应避免过多业务细节，防止恶意探测


ref

api接口常见漏洞与设计防范.md
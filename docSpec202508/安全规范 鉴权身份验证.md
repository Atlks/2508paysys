


常见鉴权机制
鉴权方式	描述说明
✅ API Key + Secret	每个调用方分配一对密钥，使用签名算法（如 HMAC-SHA256）验证请求合法性
✅ Token机制（JWT）	登录后获取令牌，后续请求携带 Token，服务端验证其有效性与权限
✅ 动态签名机制	请求中包含 appId + timestamp + nonce + sign，服务端验证签名与时间窗口


OAuth2.0授权	第三方通过授权流程获取访问令牌，适用于用户授权场景（如微信/支付宝登录）
✅ HTTP Basic认证	请求头携带 Base64 编码的用户名密码，适合简单系统（需配合 HTTPS）


推荐做法（三方支付场景）
每个商户分配唯一的 AppId / AppKey / AppSecret

AppId：标识调用方身份

AppSecret：用于签名校验，必须保密

请求参数签名

使用 AppSecret 对请求参数 + 时间戳 + nonce 进行签名

服务端验证签名是否一致，防止篡改

时间戳 + nonce 防重放攻击

时间戳限制请求在 5 分钟内有效

nonce 保证请求唯一性，服务端缓存已使用的 nonce



微信支付 V3、支付宝开放平台都采用 签名 + 时间戳 + nonce 的组合方式

 

所有鉴权失败应返回明确的错误码（如 401 Unauthorized, INVALID_SIGNATURE）




核心区别对比
维度	API Key + Secret	动态签名机制
🔐 鉴权方式	静态密钥对（AppKey / AppSecret）	每次请求都生成签名：AppId + 时间戳 + nonce
📦 参数内容	一般仅携带 API Key + 签名	需要携带更多参数：appId、timestamp、nonce、sign
🕒 安全性	静态密钥，易泄露，需通过 HTTPS 防护	加入时间戳 + nonce，可有效防重放攻击
🔁 防重放攻击	需要额外机制支持，如请求 ID、IP 限制	时间戳 + nonce 自带防重放能力
⚙️ 实现复杂度	简单，常用于低风险系统	稍复杂，更适合金融类接口（支付、回调）
🧩 场景推荐	REST API 接口、数据查询类调用	高价值交易接口，如支付、下单、回调验证等


三方支付或交易相关接口，建议使用 动态签名机制 ——更安全，防篡改与防重放。
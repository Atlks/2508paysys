

其实 timestamp + nonce 组合才是更严谨的防重放机制。原因如下：

🧨 为什么单靠 timestamp 不够安全？
虽然 timestamp 能限制请求在某个时间窗口内有效，但它存在两个问题：

时间同步风险：客户端和服务端时间如果不同步（哪怕偏差几秒），可能导致合法请求被误判为过期，或反过来放行伪造请求。

重发漏洞：在有效时间窗口内，攻击者可以多次重放相同请求，尤其是接口本身无幂等控制时。

🛡️ nonce 的作用是什么？
nonce（随机数或唯一标识符）是用来保证请求的唯一性。通常配合 timestamp 使用，形成更稳健的防护：

字段	作用
timestamp	限制请求有效期（如5分钟内）
nonce	标记每个请求唯一性，防止重复使用
服务器会记录近期使用过的 nonce 值，如果发现同一个 nonce 被重复使用，则拒绝该请求 —— 无论它是否在时间窗口内。

✅ 推荐实现方式
接口接收参数如：timestamp、nonce、sign

服务端做校验逻辑：

timestamp 是否在有效时间内

nonce 是否已被使用（可用 Redis / 内存存储做短期记录）

sign 是否匹配（签名校验防篡改）

这样组合起来可以有效防止：

请求被截获后在短时间内多次重放

伪造时间窗口内的请求

参数被篡改后伪造签名


# 幂等接口
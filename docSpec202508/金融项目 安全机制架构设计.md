
金融项目 安全机制架构设计.md

# 基本web安全

xss




# 权限分级管理


# 安全审计
登录日志	记录登录时间、IP、设备信息，有利于审计和安全追踪
✅ 操作日志	记录管理员对系统的关键操作，如新增用户、修改设置等
✅ 会话管理	展示在线管理员，强制退出、限制多设备登录等功能提升安全性
✅ 密码强度校验	修改/重置密码时校验密码复杂度，防止弱密码泄露
✅ 多因素认证	登录时支持短信验证码、邮箱验证码或二步验证机制
✅ 冻结/锁定账户	登录失败次数超限时自动锁定管理员账号，防暴力破解
✅ 安全提示	在敏感操作（如重置密码、修改权限）时弹出确认框或发送通知



限流  熔断 降级


# 签名机制


防止重放攻击  stimestamp模式


🔐 安全设计建议清单
安全项	建议方案
🔒 请求签名验证	使用 RSA 或 HMAC 算法，严格按平台文档要求构造签名串
🕰 时间戳 + 随机串校验	防止重放攻击，校验有效时间窗口 + nonce 串
📑 幂等性支持	通过 out_trade_no 或业务请求 ID 实现幂等处理
🧑‍💻 IP白名单限制	回调地址或接口仅允许指定来源 IP 请求
🧭 接口权限控制	商户或调用方需身份验证（如 token / appId / appSecret）
🔐 加密存储密钥	所有私钥、商户证书等敏感信息应加密存储
🔍 签名串日志追踪	异常签名请求记录日志，辅助排查
🚧 防刷机制	限制请求频率，如 IP 限流、接口限流

数据传输安全	全链路 HTTPS；接口参数、body 加密传输（如 AES）
身份认证与权限控制	强身份认证机制（如 OAuth2 + JWT），接口鉴权及分级权限管理
安全审计与追踪	所有交易及敏感操作均需审计记录，包括接口调用、参数变更等
防火墙与反爬机制	接入层启用 WAF，设限速策略，应对刷单或接口滥用攻击
操作隔离	高敏操作（如提现、退款）使用双因子认证 + 冻结期设计


# 统计方面
要是有聚合函数，不要增量统计，数据容易错乱


# cache尽可能少用cache

# 合规要求

符合iso20022，obie 等规范



🔁 数据一致性设计规范
类型	设计建议
聚合统计	始终使用全量聚合查询；避免写时增量更新计数，防止并发数据错乱
分布式事务	引入 TCC、SAGA、或本地事务 + 异步补偿机制
幂等处理	每笔交易、回调都需幂等设计，保证重复请求不会修改结果状态
强一致性关键点	资金变动、账务入账等关键操作采用强一致机制，例如锁或队列串行
消息队列	保证顺序投递（如 Kafka partition key）+ 消息持久化
数据回写补偿	异常场景如写入失败，需具备数据补偿方案


🧪 核心接口引入合约测试：定义稳定接口协议，避免回调参数变化引发系统问题。

🧾 数据版本控制：设计数据对象版本号，兼容历史数据变化，防止错误回溯。

🧍‍♂️ 操作人可识别：所有数据变更日志须记录操作人，便于审计与权限追溯。

⏰ 接口请求时序控制：部分敏感业务避免并发操作，如退款同时只能发起一次请求。

🕵️‍♂️ 风控策略分层：前置拦截、交易行为分析、黑名单机制协同工作。